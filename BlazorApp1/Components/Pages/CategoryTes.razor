@using static BlazorApp1.Components.Pages.Product

<div>
    <select @onchange="HandleSelection">
        <option value="">Select Category</option>
        @foreach (var category in Categories)
        {
            <option value="@category.Id">@category.Name</option>
        }
    </select>

    @if (SelectedCategory?.Subcategories?.Count > 0)
    {
        <CategoryTes 
            Categories="SelectedCategory.Subcategories" 
            OnCategorySelected="OnCategorySelected" 
        />
    }
</div>

@code {
    [Parameter] public List<CategoryTesModel> Categories { get; set; } = new();
    [Parameter] public EventCallback<CategoryTesModel> OnCategorySelected { get; set; }

    private CategoryTesModel? SelectedCategory;

    private void HandleSelection(ChangeEventArgs e)
    {
        int selectedId = int.TryParse(e.Value?.ToString(), out var id) ? id : 0;
        SelectedCategory = Categories.FirstOrDefault(c => c.Id == selectedId);

        if (SelectedCategory != null)
        {
            OnCategorySelected.InvokeAsync(SelectedCategory);
        }
    }

}
